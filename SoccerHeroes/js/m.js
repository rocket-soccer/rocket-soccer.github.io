var screenDims;var game;setTimeout(function(){initGameStates()},100);var MainGame={Config:{GAME_WIDTH:640,GAME_HEIGHT:756},title:"soccerheroes_v1",orientated:false,languages:["EN","ES","IT","FR","RU","DE","PT","BR","TR"],language:0,styleTextTb:{font:"40px YANONEKAFFEESATZ",fill:"#000000",align:"center"},styleText:{font:"56px YANONEKAFFEESATZ",fill:"#477095",align:"center"},styleTextW:{font:"56px YANONEKAFFEESATZ",fill:"#83C62B",align:"center"},styleTextL:{font:"56px YANONEKAFFEESATZ",fill:"#F0444D",align:"center"},styleText2:{font:"50px YANONEKAFFEESATZ",fill:"#477095",align:"center"},styleText3:{font:"42px YANONEKAFFEESATZ",fill:"#FFFFFF",align:"center"},GAME_TEXT:null,TEXT_FILE:null,weakDevice:false,onDesktop:false,linkLogoAPI:null,linkMoreAPI:null,linkTweetAPI:null,logoIsLoaded:false,linkAPI:null,pauseForAds:false,fadeColor:0,textFPS:null,showFPS:false,isPaused:false,isGoAway:false,isMusicMuted:false,isMusicPlaying:-1,nextState:null,isNextLevel:false,gameOver:false,s_musicM:null,s_sounds1:null,s_sounds2:null,s_sounds3:null,s_sounds4:null,firstTime:true,firstGo:true,highscore:0,typeHero:1,ourGroup:0,typeOpponent:1,playedGames:0,winGames:0,lastResult:-1,balls:0,lastScore:0,playedAr:[0,0,0,0,0,0,0],teamsAll:[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],team18Final:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ourPlace14:0,team14Final:[0,0,0,0,0,0,0,0],ourPlace12:0,team12Final:[0,0,0,0],ourPlaceFinal:0,teamFinal:[0,0],lives:0,maxLives:3,rateTeams:[23.2,33.5,28,31.2,35.9,31.3,27.1,24.5,40.2,22.9,28.3,30.3,30.6,29.4,37.9,7,34.4,34.3,26.9,29,30.9,27.1,25.3,35.1],initSettings:function(){game.add.text(0,0,"0123456789",MainGame.styleText).destroy();game.add.text(0,0,"0123456789",MainGame.styleText2).destroy();game.add.text(0,0,"0123456789",MainGame.styleText3).destroy();game.add.text(0,0,"0123456789",MainGame.styleTextW).destroy();game.add.text(0,0,"0123456789",MainGame.styleTextL).destroy();game.add.text(0,0,"0123456789",MainGame.styleTextTb).destroy();MainGame.loadSaves();MainGame.midX=Math.ceil(MainGame.Config.GAME_WIDTH/2);if(game.device.desktop){game.canvas.oncontextmenu=function(e){e.preventDefault()};window.addEventListener("keydown",function(e){if([32,37,38,39,40].indexOf(e.keyCode)>-1){e.preventDefault()}},false)}},initGameVars:function(){MainGame.playedGames=0;MainGame.winGames=0;MainGame.lastResult=-1;MainGame.playedAr=[0,0,0,0,0,0,0];MainGame.teamsAll=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]];MainGame.team18Final=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];MainGame.ourPlace14=0;MainGame.team14Final=[0,0,0,0,0,0,0,0];MainGame.ourPlace12=0;MainGame.team12Final=[0,0,0,0];MainGame.ourPlaceFinal=0;MainGame.teamFinal=[0,0]},loadSaves:function(){var sData;sData=localStorage[MainGame.title+"-language"];if(sData!=undefined&&sData!="null")MainGame.language=JSON.parse(sData);sData=localStorage[MainGame.title+"-typeHero"];if(sData!=undefined&&sData!="null")MainGame.typeHero=JSON.parse(sData);sData=localStorage[MainGame.title+"-playedGames"];if(sData!=undefined&&sData!="null")MainGame.playedGames=JSON.parse(sData);sData=localStorage[MainGame.title+"-winGames"];if(sData!=undefined&&sData!="null")MainGame.winGames=JSON.parse(sData);sData=localStorage[MainGame.title+"-lastResult"];if(sData!=undefined&&sData!="null")MainGame.lastResult=JSON.parse(sData);sData=localStorage[MainGame.title+"-playedAr"];if(sData!=undefined&&sData!="null")MainGame.playedAr=JSON.parse(sData);sData=localStorage[MainGame.title+"-teamsAll"];if(sData!=undefined&&sData!="null")MainGame.teamsAll=JSON.parse(sData);sData=localStorage[MainGame.title+"-team18Final"];if(sData!=undefined&&sData!="null")MainGame.team18Final=JSON.parse(sData);sData=localStorage[MainGame.title+"-ourPlace14"];if(sData!=undefined&&sData!="null")MainGame.ourPlace14=JSON.parse(sData);sData=localStorage[MainGame.title+"-team14Final"];if(sData!=undefined&&sData!="null")MainGame.team14Final=JSON.parse(sData);sData=localStorage[MainGame.title+"-ourPlace12"];if(sData!=undefined&&sData!="null")MainGame.ourPlace12=JSON.parse(sData);sData=localStorage[MainGame.title+"-team12Final"];if(sData!=undefined&&sData!="null")MainGame.team12Final=JSON.parse(sData);sData=localStorage[MainGame.title+"-ourPlaceFinal"];if(sData!=undefined&&sData!="null")MainGame.ourPlaceFinal=JSON.parse(sData);sData=localStorage[MainGame.title+"-teamFinal"];if(sData!=undefined&&sData!="null")MainGame.teamFinal=JSON.parse(sData)},saveSaves:function(){localStorage.setItem(MainGame.title+"-language",JSON.stringify(MainGame.language));localStorage.setItem(MainGame.title+"-typeHero",JSON.stringify(MainGame.typeHero));localStorage.setItem(MainGame.title+"-playedGames",JSON.stringify(MainGame.playedGames));localStorage.setItem(MainGame.title+"-winGames",JSON.stringify(MainGame.winGames));localStorage.setItem(MainGame.title+"-lastResult",JSON.stringify(MainGame.lastResult));localStorage.setItem(MainGame.title+"-playedAr",JSON.stringify(MainGame.playedAr));localStorage.setItem(MainGame.title+"-teamsAll",JSON.stringify(MainGame.teamsAll));localStorage.setItem(MainGame.title+"-team18Final",JSON.stringify(MainGame.team18Final));localStorage.setItem(MainGame.title+"-ourPlace14",JSON.stringify(MainGame.ourPlace14));localStorage.setItem(MainGame.title+"-team14Final",JSON.stringify(MainGame.team14Final));localStorage.setItem(MainGame.title+"-ourPlace12",JSON.stringify(MainGame.ourPlace12));localStorage.setItem(MainGame.title+"-team12Final",JSON.stringify(MainGame.team12Final));localStorage.setItem(MainGame.title+"-ourPlaceFinal",JSON.stringify(MainGame.ourPlaceFinal));localStorage.setItem(MainGame.title+"-teamFinal",JSON.stringify(MainGame.teamFinal))},clearSaves:function(){localStorage[MainGame.title+"-language"]=null;localStorage[MainGame.title+"-typeHero"]=null;localStorage[MainGame.title+"-playedGames"]=null;localStorage[MainGame.title+"-winGames"]=null;localStorage[MainGame.title+"-lastResult"]=null;localStorage[MainGame.title+"-playedAr"]=null;localStorage[MainGame.title+"-teamsAll"]=null;localStorage[MainGame.title+"-team18Final"]=null;localStorage[MainGame.title+"-ourPlace14"]=null;localStorage[MainGame.title+"-team14Final"]=null;localStorage[MainGame.title+"-ourPlace12"]=null;localStorage[MainGame.title+"-team12Final"]=null;localStorage[MainGame.title+"-ourPlaceFinal"]=null;localStorage[MainGame.title+"-teamFinal"]=null}};SimpleButton=function(game,link,kuda,x,y,key,frame,callback,animationScale,vText,vDx,vDy){if(typeof vText==="undefined"){vText=""}if(typeof vDx==="undefined"){vDx=0}if(typeof vDy==="undefined"){vDy=0}if(typeof animationScale==="undefined"){animationScale=0}this.game=game;if(kuda==null){this.buttonC=game.add.group()}else{this.buttonC=kuda.add(game.add.group())}this.buttonC.x=x;this.buttonC.y=y;this.button=this.buttonC.add(this.game.add.sprite(0,0,key,frame));this.button.game=this.game;this.button.anchor.setTo(.5,.5);this.button.inputEnabled=true;if(this.game.device.desktop)this.button.input.useHandCursor=true;if(vText!=""){var text=this.buttonC.add(game.add.text(0+vDx,0+vDy,vText.toUpperCase(),MainGame.styleText));text.anchor.set(.5)}this.button.events.onInputDown.add(function(){this.game.add.tween(this.buttonC.scale).to({x:.9,y:.9},200,Phaser.Easing.Cubic.Out,true);this.game.add.tween(this.buttonC.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.Out,true,260);this.game.time.events.add(250,callback,link)},this);if(animationScale>0){this.game.add.tween(this.buttonC.scale).to({x:animationScale,y:animationScale},630,Phaser.Easing.Linear.None).to({x:1,y:1},630,Phaser.Easing.Linear.None).loop().start()}};function initGameStates(){screenDims=Utils.ScreenUtils.calculateScreenMetrics(640,890,0,710,960);game=new Phaser.Game(screenDims.gameWidth,screenDims.gameHeight,Phaser.AUTO);game.state.add("Boot",MainGame.Boot,true);game.state.add("Preloader",MainGame.Preloader);game.state.add("Menu",MainGame.Menu);game.state.add("Game",MainGame.Game);game.state.add("Credits",MainGame.Credits);game.state.add("SelectTeam",MainGame.SelectTeam);game.state.add("ScreenTable1",MainGame.ScreenTable1);game.state.add("ScreenTable2",MainGame.ScreenTable2);game.state.add("ScreenTable3",MainGame.ScreenTable3);game.state.add("ScreenWin",MainGame.ScreenWin);setTimeout(function(){window.scrollTo(0,1)},100)}function addLogo(vX,vY,vScale,vIsCenter,vContainer){if(typeof vIsCenter==="undefined"){vIsCenter=false}if(typeof vContainer==="undefined"){vContainer=null}if(MainGame.logoIsLoaded===true){var logo;if(vContainer!=null){logo=vContainer.add(game.add.sprite(vX,vY,"logoSponsor"))}else{logo=game.add.sprite(vX,vY,"logoSponsor")}if(vIsCenter)logo.anchor.setTo(.5,.5);logo.scale.setTo(vScale,vScale);logo.inputEnabled=true;logo.events.onInputUp.add(clickLogo2,this)}}function showFps(){game.time.advancedTiming=true;MainGame.textFPS=game.add.text(20,130,"FPS",{font:"30px Arial",fill:"#FFFFFF",align:"center"});MainGame.textFPS.fixedToCamera=true}function trace(a){console.log(a)}function clickLogo(){if(MainGame.clickOne)return;GamifiveSDK.goToHome();MainGame.clickOne=true;game.time.events.add(500,clickOneBack,this)}function clickLogo2(){if(MainGame.clickOne)return;GamifiveSDK.goToHome();MainGame.clickOne=true;game.time.events.add(500,clickOneBack,this)}function clickOneBack(){MainGame.clickOne=false}function clearGame(){game.tweens.removeAll()}function goToState(pNextState){game.tweens.removeAll();var spr_bg=this.game.add.graphics(0,0);spr_bg.beginFill(MainGame.fadeColor,1);spr_bg.drawRect(0,0,this.game.width,this.game.height);spr_bg.alpha=0;spr_bg.endFill();MainGame.nextState=pNextState;var s=this.game.add.tween(spr_bg);s.to({alpha:1},200,Phaser.Easing.Linear.None);s.onComplete.add(this.changeState,this);s.start()}function goChangeState(pNextState){game.tweens.removeAll();var spr_bg=this.game.state.states.Game.panelScreen.add(this.game.add.graphics(-MainGame.sdvigX,0));spr_bg.beginFill(MainGame.fadeColor,1);spr_bg.drawRect(0,0,this.game.width,this.game.height);spr_bg.alpha=0;spr_bg.endFill();MainGame.nextState=pNextState;var s=this.game.add.tween(spr_bg);s.to({alpha:1},400,Phaser.Easing.Linear.None);s.onComplete.add(this.changeState,this);s.start()}function changeState(){this.game.state.start(MainGame.nextState);if(MainGame.isNextLevel){this.game.state.start("game")}}function fadeOut(){var spr_bg=this.game.add.graphics(0,0);spr_bg.beginFill(MainGame.fadeColor,1);spr_bg.drawRect(0,0,this.game.width,this.game.height);spr_bg.alpha=1;spr_bg.endFill();game.add.tween(spr_bg).to({alpha:0},150,Phaser.Easing.Linear.None).start()}function muteSounds(btn){this.game.add.tween(btn.scale).to({x:.9,y:.9},200,Phaser.Easing.Cubic.Out,true);this.game.add.tween(btn.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.Out,true,260);if(game.sound.mute){btn.frameName="btn_sound_0000"}else{btn.frameName="btn_sound_0001"}game.sound.mute=!game.sound.mute;MainGame.isMusicMuted=game.sound.mute}function playMusic(num){if(MainGame.isMusicPlaying===num)return;MainGame.s_musicM.play("",0,1,true);MainGame.isMusicPlaying=num}function stopMusic(){if(game.device.webAudio){MainGame.isMusicPlaying=-1;if(MainGame.s_musicM!=null)MainGame.s_musicM.stop()}}function playSound(num){if(game.device.webAudio){switch(num){case 1:MainGame.s_sounds1.play();break;case 2:MainGame.s_sounds2.play();break;case 3:MainGame.s_sounds3.play();break;case 4:MainGame.s_sounds4.play();break}}}function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}function getRandomBool(){return Math.random()<.5?true:false}function shuffleArr(o){for(var j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);return o}MainGame.Boot=function(game){};MainGame.Boot.prototype={init:function(){this.input.maxPointers=1;game.forceSingleUpdate=true;var screenDims=Utils.ScreenUtils.screenMetrics;if(this.game.device.desktop){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.updateLayout()}else{this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;this.scale.forceLandscape=true;this.scale.updateLayout();this.scale.forceOrientation(false,true);this.scale.setResizeCallback(this.gameResized,this);this.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this);this.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this)}this.load.crossOrigin="anonymous";MainGame.sdvigX=screenDims.offsetX;MainGame.Config.GAME_WIDTH=screenDims.gameWidth;MainGame.Config.GAME_HEIGHT=screenDims.gameHeight;MainGame.Config.SCREEN_MIDX=screenDims.gameWidth/2;MainGame.Config.SCREEN_MIDY=screenDims.gameHeight/2;this.game.onPause.add(this.onGamePause,this);this.game.onResume.add(this.onGameResume,this);MainGame.oldWorldX=game.world.centerX;MainGame.oldWorldY=game.world.centerY;MainGame.initSettings()},preload:function(){this.load.image("preloaderBackground","assets/preloader_back.png?r=1");this.load.image("preloaderBar","assets/preloader_bar.png?r=1")},create:function(){this.state.start("Preloader")},onGamePause:function(){if(!game.sound.mute){MainGame.isGoAway=true;game.sound.mute=true}else{MainGame.isGoAway=false}},onGameResume:function(){if(MainGame.isGoAway){game.sound.mute=false}},enterIncorrectOrientation:function(){setTimeout(function(){window.scrollTo(0,1)},100);MainGame.orientated=false;document.getElementById("orientation").style.display="block";if(!game.device.android){document.getElementById("orientation").style.width=window.innerWidth+"px";document.getElementById("orientation").style.height=window.innerHeight+"px"}},leaveIncorrectOrientation:function(){MainGame.orientated=true;if(MainGame.loadIncorrect)window.location.reload();document.getElementById("orientation").style.display="none"}};MainGame.Preloader=function(game){this.background=null;this.preloadBar=null;this.ready=false};MainGame.Preloader.prototype={preload:function(){game.stage.backgroundColor="#0E93CB";addLogo(MainGame.Config.SCREEN_MIDX+10,MainGame.Config.SCREEN_MIDY+150,1.1,true);var width=Math.ceil(557/2);this.background=this.add.sprite(MainGame.Config.SCREEN_MIDX-width,MainGame.Config.SCREEN_MIDY+20,"preloaderBackground");this.preloadBar=this.add.sprite(MainGame.Config.SCREEN_MIDX-width,MainGame.Config.SCREEN_MIDY+20,"preloaderBar");this.load.setPreloadSprite(this.preloadBar);game.load.audio("music-menu",["assets/audio/ogg/music.ogg?r=1","assets/audio/mp3/music.mp3?r=1"]);if(this.game.device.webAudio){game.load.audio("sfx_crowd",["assets/audio/ogg/sfx_crowd.ogg","assets/audio/mp3/sfx_crowd.mp3"]);game.load.audio("sfx_pinok",["assets/audio/ogg/sfx_pinok.ogg","assets/audio/mp3/sfx_pinok.mp3"])}game.load.json("alltext","assets/text/text.json");game.load.atlasJSONHash("ss_game1","assets/spritesheets/ss_game1.png?r=2","assets/spritesheets/ss_game1.json?r=2");game.load.atlasJSONHash("ss_game2","assets/spritesheets/ss_game2.png?r=1","assets/spritesheets/ss_game2.json?r=1");game.load.atlasJSONHash("ss_main","assets/spritesheets/ss_main.png?r=4","assets/spritesheets/ss_main.json?r=4");game.load.atlasJSONHash("ss_table","assets/spritesheets/ss_table.png?r=1","assets/spritesheets/ss_table.json?r=1")},create:function(){MainGame.s_musicM=game.add.audio("music-menu",1,true);if(this.game.device.webAudio){MainGame.s_sounds1=game.add.audio("sfx_crowd",2.5);MainGame.s_sounds2=game.add.audio("sfx_pinok",1.2)}MainGame.TEXT_FILE=game.cache.getJSON("alltext");this.preloadBar.cropEnabled=false},update:function(){if(this.ready==false){this.ready=true;game.state.start("Menu")}}};MainGame.Game=function(game){this.layerBack=null;this.layerMain=null;this.layerGame=null;this.layerMap=null;this.layerTen=null;this.layerBonuses=null;this.player=null;this.gatekeeper=null;this.playerWall1=null;this.playerWall2=null;this.playerWall3=null;this.numOpponentTeam=0;this.isPlayerAdded=false;this.cameraSprite=null;this.SPEED_Y=-400;this.mapPart1=null;this.mapPart2=null;this.mapPart3=null;this.swapLine=0;this.numSwap=0;this.countPoz=0;this.lineStart=0;this.countZones=0;this.sizeZone=0;this.zonaFinish=null;this.bonusesG=null;this.indikator1=null;this.indikator2=null;this.indikator3=null;this.heroAttack=false;this.timeUlt=false;this.TIMER_ULT=2e3;this.textBabki=null;this.textDeliver=null;this.tenSprite=null;this.countBonuses=0;this.posulka=null;this.countAddMonsters=0;this.posXmax=0;this.posXmin=0;this.flag=null;this.isTimePinok=false;this.isReadyToPinok=false;this.playerPnul=false;this.finishWin=false;this.pinokStep=0};MainGame.Game.prototype={create:function(){game.state.states.Game.initLevel();MainGame.gameStarted=true},initLevel:function(){MainGame.gameOver=false;this.layerBack=game.add.group();this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;this.createLevel();this.panelGUI();this.posXmax=565+MainGame.sdvigX;this.posXmin=50+MainGame.sdvigX;dataLayer.push({event:"levelStart",publisher:"Buongiorno",productKey:"soccerHeroes"})},createLevel:function(){game.physics.startSystem(Phaser.Physics.ARCADE);this.mapPart1=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000"));this.mapPart1.anchor.setTo(.5,0);this.mapPart2=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000"));this.mapPart2.anchor.setTo(.5,0);this.mapPart3=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000"));this.mapPart3.anchor.setTo(.5,0);this.layerMap=this.layerMain.add(game.add.group());this.layerTen=this.layerMain.add(game.add.group());this.layerTen.fixedToCamera=true;this.layerBonuses=this.layerMain.add(game.add.group());this.layerGame=this.layerMain.add(game.add.group());this.bonusesG=this.layerMain.add(game.add.group());this.pinokStep=0;this.countZones=6;this.sizeZone=1260;this.swapLine=this.sizeZone*(this.countZones-2);this.numSwap=3;this.lineStart=this.countZones*this.sizeZone;game.world.setBounds(0,0,640,this.lineStart);this.mapPart1.y=this.sizeZone*(this.countZones-3);this.mapPart2.y=this.sizeZone*(this.countZones-2);this.mapPart3.y=this.sizeZone*(this.countZones-1);this.countPoz=3;var posGateY=0;this.zonaFinish1=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,-115+posGateY,"ss_game1","gate_zona_0000"));this.zonaFinish1.anchor.setTo(.5,0);this.zonaFinish3=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,204+posGateY,"ss_game1","shtrafzone_0000"));this.zonaFinish3.anchor.setTo(.5,0);this.zonaFinish4=this.layerBack.add(game.add.sprite(MainGame.oldWorldX,476+posGateY,"ss_game1","chentr_0000"));this.zonaFinish4.anchor.setTo(.5,0);var posStart=-190;var startPostion=this.lineStart+posStart;this.cameraSprite=game.add.sprite(MainGame.oldWorldX,startPostion);this.cameraSprite.anchor.setTo(.5,.5);game.physics.enable(this.cameraSprite);game.camera.follow(this.cameraSprite);this.cameraSprite.body.velocity.y=this.SPEED_Y;this.numOpponentTeam=MainGame.typeOpponent+1;this.addKeeper(320,255);this.addPlayer(320,startPostion);this.zonaFinish2=this.layerMain.add(game.add.sprite(320,125+posGateY,"ss_game1","gate_0000"));this.zonaFinish2.anchor.setTo(.5,0);this.enemies=[];this.enemiesTotal=0;this.countBonuses=0;this.countMonsterKilled=0;this.countEarned=0;this.ultUsed=0;this.bonusesG.enableBody=true;game.input.onUp.add(this.useUlt,this);game.input.onDown.add(this.usePinok,this);this.addBonuses(this.mapPart3.y);this.countAddMonsters=3;this.addMonsters(this.countAddMonsters,this.mapPart3.y-100,this.layerBonuses);playMusic(0);this.maxWallY=MainGame.Config.GAME_HEIGHT*1.1;this.isTimePinok=false;this.isReadyToPinok=false;this.playerPnul=false;this.finishWin=false},addBonuses:function(vY){var bonusesX=[3,4,5,6,7];shuffleArr(bonusesX);this.addBonus(60*bonusesX[0],vY+80*getRandomInt(0,5));this.addBonus(60*bonusesX[1],vY+80*getRandomInt(0,5));this.addBonus(60*bonusesX[2],vY+80*getRandomInt(0,5))},addMonsters:function(vCount,vTopLine,vKuda){vTopLine-=600;var bonusesX=[3,4,5,6,7];shuffleArr(bonusesX);for(var j=0;j<vCount;j++){this.addBot(60*bonusesX[j],vTopLine+10*getRandomInt(5,35),vKuda)}},addBot:function(vX,vY,vGate){this.enemies.push(new Bot(MainGame.playedGames,game,this.player,vX,vY,vGate,this.numOpponentTeam));this.enemiesTotal=this.enemies.length},addBonus:function(vX,vY){var box=this.bonusesG.add(game.add.sprite(vX,vY,"ss_game1"));box.anchor.setTo(.5,.5);box.animations.add("ball_bonus",Phaser.Animation.generateFrameNames("ball_bonus_",0,11,"",4),30);box.animations.play("ball_bonus",30,true);box.body.setSize(50,50,0,20)},addBonusPick:function(vX,vY){var obj=this.layerBonuses.add(game.add.sprite(vX,vY,"ss_game1"));obj.anchor.setTo(.5,.5);obj.animations.add("bonuspickup",Phaser.Animation.generateFrameNames("bonus_pickup_",0,11,"",4),30);obj.animations.play("bonuspickup",30,false,true)},addMonstrDead:function(vX,vY){var blood=this.layerBonuses.add(game.add.sprite(vX,vY+30,"ss_game1","headstone_0000"));blood.anchor.setTo(.5,.5);var obj=this.layerBonuses.add(game.add.sprite(vX+10,vY+3,"ss_game1"));obj.anchor.setTo(.5,.5);obj.animations.add("monstr_dead",Phaser.Animation.generateFrameNames("monstr_dead_",0,14,"",4),30);obj.animations.play("monstr_dead",30,false,true)},swapMap:function(){if(this.countPoz>this.countZones)return;if(this.numSwap==3){this.mapPart3.y=(this.countZones-this.countPoz-1)*this.sizeZone;this.numSwap=2}else if(this.numSwap==2){this.mapPart2.y=(this.countZones-this.countPoz-1)*this.sizeZone;this.numSwap=1}else if(this.numSwap==1){this.mapPart1.y=(this.countZones-this.countPoz-1)*this.sizeZone;this.numSwap=3}this.swapLine=this.sizeZone*(this.countZones-this.countPoz);this.countPoz++;if(this.countPoz==4){this.addBonuses(this.mapPart1.y+200);this.countAddMonsters++;this.addMonsters(this.countAddMonsters,this.mapPart1.y+300,this.layerBonuses)}else if(this.countPoz==6){this.addBonuses(this.mapPart2.y+400);this.countAddMonsters++;this.addMonsters(this.countAddMonsters,this.mapPart2.y+450,this.layerBonuses)}},addKeeper:function(vX,vY){this.gatekeeper=this.layerMain.add(game.add.sprite(vX,vY,"ss_game2"));this.gatekeeper.animations.add("gK",Phaser.Animation.generateFrameNames("k"+this.numOpponentTeam+"_",0,12,"",4),30);this.gatekeeper.animations.play("gK",30,true);this.gatekeeper.anchor.setTo(.5,.5);var side=getRandomInt(0,1);this.sideStenka=side;var _posX=320-110;if(side==0)_posX=320+110;this.playerWall1=this.layerMain.add(game.add.sprite(_posX,370,"ss_game2"));this.playerWall1.animations.add("pw1",Phaser.Animation.generateFrameNames("e"+this.numOpponentTeam.toString()+"_run_",0,19,"",4),30);this.playerWall1.animations.play("pw1",30,true);this.playerWall1.animations.currentAnim.stop();this.playerWall1.animations.currentAnim.frame=8;this.playerWall1.anchor.setTo(.5,.5);if(side==0){this.playerWall1.scale.setTo(-1,1)}else{this.playerWall1.scale.setTo(1,1)}this.playerWall2=this.layerMain.add(game.add.sprite(_posX+60,370,"ss_game2"));this.playerWall2.animations.add("pw1",Phaser.Animation.generateFrameNames("e"+this.numOpponentTeam.toString()+"_run_",0,19,"",4),30);this.playerWall2.animations.play("pw1",30,true);this.playerWall2.animations.currentAnim.stop();this.playerWall2.animations.currentAnim.frame=8;this.playerWall2.anchor.setTo(.5,.5);if(side==0){this.playerWall2.scale.setTo(-1,1)}else{this.playerWall2.scale.setTo(1,1)}this.playerWall3=this.layerMain.add(game.add.sprite(_posX-60,370,"ss_game2"));this.playerWall3.animations.add("pw1",Phaser.Animation.generateFrameNames("e"+this.numOpponentTeam.toString()+"_run_",0,19,"",4),30);this.playerWall3.animations.play("pw1",30,true);this.playerWall3.animations.currentAnim.stop();this.playerWall3.animations.currentAnim.frame=8;this.playerWall3.anchor.setTo(.5,.5);if(side==0){this.playerWall3.scale.setTo(-1,1)}else{this.playerWall3.scale.setTo(1,1)}if(MainGame.playedGames==0){_posX=320+100;if(side==0)_posX=320-100;this.helper=this.layerMain.add(game.add.sprite(_posX,415,"ss_game1"));this.helper.animations.add("cursor3",Phaser.Animation.generateFrameNames("cursor3_",0,19,"",4),30);this.helper.animations.play("cursor3",30,true);this.helper.anchor.setTo(.5,.5)}},addPlayer:function(vX,vY){this.ball=this.layerMain.add(game.add.sprite(vX,vY,"ss_game1"));this.ball.animations.add("ball_run",Phaser.Animation.generateFrameNames("ball_run_",0,39,"",4),30);this.ball.animations.play("ball_run",30,true);this.ball.anchor.setTo(.5,.5);this.ballUlt=this.layerMain.add(game.add.sprite(vX,vY,"ss_game1"));this.ballUlt.animations.add("ball_attack",Phaser.Animation.generateFrameNames("ball_attack_",0,9,"",4),30);this.ballUlt.animations.play("ball_attack",30,true);this.ballUlt.anchor.setTo(.5,.7);this.ballUlt.visible=false;this.ballUlt.rotation=Phaser.Math.degToRad(180);var num=Number(MainGame.typeHero)+1;this.player=this.layerMain.add(game.add.sprite(vX,vY,"ss_game2"));this.player.animations.add("g_run",Phaser.Animation.generateFrameNames("g"+num+"_run_",0,19,"",4),30);this.player.animations.add("g_attack",Phaser.Animation.generateFrameNames("g"+num+"_attack_",0,18,"",4),30);this.player.animations.play("g_run",30,true);this.player.anchor.setTo(.5,.5);game.physics.enable(this.player);this.player.body.setSize(50,50,0,0);this.isPlayerAdded=true;this.heroAttack=false;this.timeUlt=false},panelGUI:function(){this.fixedScreen=this.layerMain.add(game.add.group());this.panelScreen=this.layerMain.add(game.add.group());this.layerTask=this.layerMain.add(game.add.group());this.powerKick=this.panelScreen.add(game.add.group());this.fixedScreen.fixedToCamera=true;this.panelScreen.fixedToCamera=true;this.layerTask.fixedToCamera=true;this.indikator1=this.panelScreen.add(game.add.sprite(320-70,80,"ss_game1","energy0_0000"));this.indikator1.anchor.setTo(.5,1);this.indikator2=this.panelScreen.add(game.add.sprite(320,80,"ss_game1","energy0_0000"));this.indikator2.anchor.setTo(.5,1);this.indikator3=this.panelScreen.add(game.add.sprite(320+70,80,"ss_game1","energy0_0000"));this.indikator3.anchor.setTo(.5,1);var num=MainGame.typeHero;var suff="000";if(num>9)suff="00";this.flag1=this.panelScreen.add(game.add.sprite(320-500,620,"ss_game1","flagsMini_"+suff+num));this.flag1.anchor.setTo(.5,.5);num=MainGame.typeOpponent;suff="000";if(num>9)suff="00";this.flag2=this.panelScreen.add(game.add.sprite(320+500,620,"ss_game1","flagsMini_"+suff+num));this.flag2.anchor.setTo(.5,.5);this.txtVS=this.panelScreen.add(game.add.sprite(320+14,622,"ss_game1","txt_vs_0000"));this.txtVS.anchor.setTo(.5,.5);var twFlag1=game.add.tween(this.flag1).to({x:320-110},450,"Back.easeOut",true);twFlag1.onComplete.add(this.twFlag1Completed,this);var twFlag2=game.add.tween(this.flag2).to({x:320+110},450,"Back.easeOut",true);twFlag2.onComplete.add(this.twFlag2Completed,this);game.add.tween(this.txtVS).to({alpha:0},250,Phaser.Easing.Linear.None,true,1200).onComplete.add(function(){game.state.states.Game.txtVS.destroy()});this.isRainAdded=false;if(getRandomBool()){this.weather=new Weather(this.game);this.weather.addRain(this.panelScreen,10);this.isRainAdded=true}},twFlag1Completed:function(){game.add.tween(game.state.states.Game.flag1).to({x:320-500},500,"Back.easeIn",true,800).onComplete.add(function(){game.state.states.Game.flag1.destroy()})},twFlag2Completed:function(){game.add.tween(game.state.states.Game.flag2).to({x:320+500},500,"Back.easeIn",true,800).onComplete.add(function(){game.state.states.Game.flag2.destroy()})},initPunchIndikator:function(){this.powerKick.y=-100;var posIndX=320;var posIndY=60;this.punch_rama1=this.powerKick.add(game.add.sprite(posIndX,posIndY-12,"ss_game1","punch_rama_0000"));this.punch_line1=this.powerKick.add(game.add.sprite(posIndX,posIndY,"ss_game1","punch_line_0000"));this.mask1=this.powerKick.add(game.add.graphics(posIndX,posIndY));this.mask1.beginFill(16777215);this.mask1.drawRect(0,0,266,50);this.punch_line1.mask=this.mask1;this.punch_rama2=this.powerKick.add(game.add.sprite(posIndX,posIndY-12,"ss_game1","punch_rama_0000"));this.punch_rama2.scale.x=-1;this.punch_line2=this.powerKick.add(game.add.sprite(posIndX,posIndY,"ss_game1","punch_line_0000"));this.punch_line2.scale.x=-1;this.mask2=this.powerKick.add(game.add.graphics(posIndX,posIndY));this.mask2.beginFill(16777215);this.mask2.drawRect(0,0,266,50);this.mask2.scale.x=-1;this.punch_line2.mask=this.mask2;this.mask1.scale.x=.5;this.mask2.scale.x=-.5;this.speedG=0;this.directionSpeed=true;game.add.tween(this.indikator1).to({y:-50},800,"Elastic.easeIn",true);game.add.tween(this.indikator2).to({y:-50},800,"Elastic.easeIn",true);game.add.tween(this.indikator3).to({y:-50},800,"Elastic.easeIn",true);game.add.tween(this.powerKick).to({y:0},900,"Elastic.easeOut",true);this.iterationTimerPower();this.arrow=this.layerMain.add(game.add.sprite(320,550,"ss_game1","arrow_0000"));this.arrow.anchor.setTo(.5,.9);this.arrow.angle=-35;this.tweenArrow=game.add.tween(this.arrow).to({angle:35},500,Phaser.Easing.Linear.None,true,0,-1,true);game.physics.enable(this.ball,Phaser.Physics.ARCADE);game.physics.enable(this.gatekeeper,Phaser.Physics.ARCADE);this.ball.body.setSize(40,40,0,0);this.gatekeeper.body.setSize(65,50,0,0)},goPinok:function(vDirection){this.playerPnul=true;if(this.arrow.angle>0){this.directionPinok=0}else{this.directionPinok=1}var hiu=game.physics.arcade.accelerationFromRotation(game.math.degToRad(this.arrow.angle-90),100+this.speedG*15);this.ball.body.velocity.x=hiu.x;this.ball.body.velocity.y=hiu.y;this.player.animations.play("g_attack",30,false);game.time.events.remove(this.timerPower);playSound(2)},iterationTimerPower:function(){if(this.directionSpeed){this.speedG+=5;if(this.speedG>=100){this.speedG=100;this.directionSpeed=!this.directionSpeed}}else{this.speedG-=5;if(this.speedG<0){this.speedG=1;this.directionSpeed=!this.directionSpeed}}this.mask1.scale.x=this.speedG/100;this.mask2.scale.x=-this.speedG/100},goToMenu:function(){if(this.isRainAdded)this.weather.removeRain();goToState("Menu")},replayGame:function(){if(this.isRainAdded)this.weather.removeRain();goChangeState("Game")},goToLevelMenu:function(){if(this.isRainAdded)this.weather.removeRain();if(MainGame.playedGames<4){goToState("ScreenTable1")}else{if(MainGame.playedGames>=4&&MainGame.playedGames<=6){goToState("ScreenTable3")}else if(MainGame.playedGames==7){goToState("ScreenWin")}}},addGameLogo:function(vX,vY,vScale,vIsCenter){if(typeof vIsCenter==="undefined"){vIsCenter=false}if(MainGame.logoIsLoaded===true){var logo=this.panelScreen.add(game.add.sprite(vX,vY,"logoSponsor"));if(vIsCenter)logo.anchor.setTo(.5,.5);logo.scale.setTo(vScale,vScale);logo.inputEnabled=true;logo.events.onInputUp.add(MainGame.linkLogoAPI.action,this)}},update:function(){if(MainGame.gameOver||!MainGame.gameStarted)return;if(!this.isTimePinok){if(this.cameraSprite.y<this.swapLine){this.swapMap()}if(!this.timeUlt){if(this.player.y<900){this.isTimePinok=true;game.state.states.Game.player.body.velocity.y=0;for(var i=0;i<this.enemiesTotal;i++){if(this.enemies[i].alive)this.enemies[i].stopFollow()}var _tTween=game.add.tween(this.player).to({x:320,y:630},600,"Linear",true);_tTween.onComplete.add(function(){game.state.states.Game.player.animations.currentAnim.stop();game.state.states.Game.player.animations.currentAnim.frame=5;game.state.states.Game.ball.animations.currentAnim.stop();game.state.states.Game.ball.animations.currentAnim.frame=0;game.state.states.Game.tweenGatekeeper=game.add.tween(game.state.states.Game.gatekeeper).to({x:320-135},400,Phaser.Easing.Linear.None).to({x:320+135},800,Phaser.Easing.Linear.None,true,0,-1,true).start();game.state.states.Game.isReadyToPinok=true});this.initPunchIndikator();return}if(game.input.activePointer.isDown){this.player.body.velocity.setTo(0,0);var posX=game.input.worldX;if(posX<this.posXmin)posX=this.posXmin;if(posX>this.posXmax)posX=this.posXmax;posX-=25;var posY=game.input.worldY-75;var xDistance=posX-this.player.body.x;var yDistance=posY-this.player.body.y;var speed=21;if(Math.sqrt(yDistance*yDistance+xDistance*xDistance)<20){this.player.body.x=posX;this.player.body.y=posY}else{var radian=Math.atan2(yDistance,xDistance);this.player.body.x+=Math.cos(radian)*speed;this.player.body.y+=Math.sin(radian)*speed}}else{this.player.body.velocity.setTo(0,this.SPEED_Y)}for(var i=0;i<this.enemiesTotal;i++){this.enemies[i].update();if(this.enemies[i].tank.y>this.player.y+730){this.enemies[i].tank.destroy();this.enemies.splice(i,1);this.enemiesTotal=this.enemies.length;break}game.physics.arcade.overlap(this.player,this.enemies[i].tank,this.botHitHero,null,this)}}game.physics.arcade.collide(this.player,this.bonusesG,this.getBonus)}else{game.physics.arcade.overlap(this.gatekeeper,this.ball,this.getPoimal,null,this);if(this.ball.y<415){if(this.directionPinok==this.sideStenka){this.ball.y=415;this.ball.body.velocity.x=0;this.ball.body.velocity.y=0;MainGame.gameOver=true;game.time.events.add(400,this.finishGame,this)}}if(this.ball.y<150){this.ball.y=150;this.ball.body.velocity.x=0;this.ball.body.velocity.y=0;this.tweenGatekeeper.stop();if(this.ball.x<320+170&&this.ball.x>320-170){this.finishWin=true;playSound(1)}MainGame.gameOver=true;game.time.events.add(300,this.finishGame,this)}}if(!this.playerPnul){this.ball.x=this.player.x;this.ball.y=this.player.y-70}if(this.cameraSprite.y<0)this.cameraSprite.body.velocity.y=0},usePinok:function(){if(MainGame.gameOver)return;if(this.isTimePinok&&this.isReadyToPinok){if(this.pinokStep==0){this.tweenArrow.stop();this.timerPower=game.time.events.loop(20,this.iterationTimerPower,this);this.pinokStep=1}else if(this.pinokStep==1){this.arrow.destroy();if(game.input.x>MainGame.Config.SCREEN_MIDX){this.goPinok(0)}else{this.goPinok(1)}}}},useUlt:function(){if(MainGame.gameOver)return;if(this.isTimePinok)return;if(this.countBonuses==3){this.countBonuses=0;game.state.states.Game.indikator1.frameName="energy0_0000";game.state.states.Game.indikator2.frameName="energy0_0000";game.state.states.Game.indikator3.frameName="energy0_0000";this.heroAttack=true;this.timeUlt=true;this.ball.visible=false;this.ballUlt.visible=true;this.ballUlt.x=this.player.x;this.ballUlt.y=this.player.y-60;this.cameraSprite.body.velocity.y=0;this.player.body.velocity.y=0;this.player.animations.currentAnim.stop();game.time.events.add(250,this.startKick,this);game.time.events.add(500,this.startBallFly,this);this.TIMER_ULT=250+500+300+this.countAddMonsters*300;game.time.events.add(this.TIMER_ULT,this.stopUlt,this);for(var i=0;i<this.enemiesTotal;i++){this.enemies[i].freeze()}this.tenSprite=game.state.states.Game.layerTen.add(game.add.graphics(-50,0));this.tenSprite.beginFill(MainGame.fadeColor,1);this.tenSprite.drawRect(0,0,this.game.width+100,this.game.height);this.tenSprite.alpha=0;this.tenSprite.endFill();game.add.tween(this.tenSprite).to({alpha:.5},200,Phaser.Easing.Linear.None,true);this.ultUsed++}},startKick:function(){this.player.animations.play("g_attack",30,false);playSound(2)},startBallFly:function(){this.goalBots=[];var _tempBot;for(var i=0;i<this.enemiesTotal;i++){_tempBot=this.enemies[i].tank;if(this.player.y-_tempBot.y<670&&this.player.y>_tempBot.y){this.goalBots.push(_tempBot)}}var _countBots=this.goalBots.length;if(_countBots==0){game.add.tween(game.state.states.Game.ballUlt).to({y:game.state.states.Game.player.y-800},400,"Quad.easeInOut",true,0,0,true)}else{var _newTween;var _arTweens=[];for(var j=0;j<_countBots;j++){_tempBot=this.goalBots[j];_newTween=game.add.tween(game.state.states.Game.ballUlt).to({x:_tempBot.x,y:_tempBot.y},300,Phaser.Easing.Circular.InOut);_newTween.onComplete.add(function(){game.state.states.Game.removeStepBot()});_arTweens.push(_newTween)}_newTween=game.add.tween(game.state.states.Game.ballUlt).to({x:this.player.x,y:this.player.y-50},300,Phaser.Easing.Circular.InOut);_arTweens.push(_newTween);for(var k=0;k<_countBots;k++)_arTweens[k].chain(_arTweens[k+1]);_arTweens[0].start();this.ballUlt.rotation=this.game.physics.arcade.angleBetween(this.player,this.goalBots[0])-1.57}},stopUlt:function(){this.player.animations.play("g_run",30,true);this.player.angle=0;game.state.states.Game.timeUlt=false;this.ballUlt.rotation=Phaser.Math.degToRad(180);game.add.tween(this.player).to({alpha:0},250,Phaser.Easing.Linear.None,true,0,3,true).onComplete.add(function(){game.state.states.Game.heroAttack=false;game.state.states.Game.player.alpha=1});game.add.tween(this.tenSprite).to({alpha:0},200,Phaser.Easing.Linear.None,true).onComplete.add(function(){game.state.states.Game.tenSprite.destroy()});this.cameraSprite.body.velocity.y=this.SPEED_Y;this.player.body.velocity.y=this.SPEED_Y;this.ball.visible=true;this.ballUlt.visible=false},getPoimal:function(vHero,vObj){this.ball.y=this.gatekeeper.y+10;this.ball.body.velocity.x=0;this.ball.body.velocity.y=0;this.tweenGatekeeper.stop();MainGame.gameOver=true;game.time.events.add(400,game.state.states.Game.finishGame,this)},getBonus:function(vHero,vObj){game.state.states.Game.addBonusPick(vObj.x+3,vObj.y+15);vObj.kill();if(game.state.states.Game.countBonuses==3)return;game.state.states.Game.countBonuses++;if(game.state.states.Game.countBonuses==1){game.state.states.Game.indikator1.frameName="energy1_0000";game.add.tween(game.state.states.Game.indikator1.scale).to({x:1.35,y:1.35},200,Phaser.Easing.Linear.None).to({x:1,y:1},200,Phaser.Easing.Linear.None).start()}else if(game.state.states.Game.countBonuses==2){game.state.states.Game.indikator2.frameName="energy1_0000";game.add.tween(game.state.states.Game.indikator2.scale).to({x:1.35,y:1.35},200,Phaser.Easing.Linear.None).to({x:1,y:1},200,Phaser.Easing.Linear.None).start()}else if(game.state.states.Game.countBonuses==3){game.state.states.Game.indikator3.frameName="energy1_0000";game.add.tween(game.state.states.Game.indikator3.scale).to({x:1.35,y:1.35},200,Phaser.Easing.Linear.None).to({x:1,y:1},200,Phaser.Easing.Linear.None).start()}},removeStepBot:function(){if(this.goalBots.length>1){this.ballUlt.rotation=this.game.physics.arcade.angleBetween(this.goalBots[0],this.goalBots[1])-1.57}else{this.ballUlt.rotation=this.game.physics.arcade.angleBetween(this.goalBots[0],this.player)-1.57}this.removeBot(this.goalBots[0]);this.goalBots.splice(0,1)},removeBot:function(vBot){this.enemiesTotal=this.enemies.length;for(var i=this.enemiesTotal-1;i>=0;i--){if(this.enemies[i]===vBot.bot){this.enemies.splice(i,1);this.enemiesTotal=this.enemies.length;break}}this.addMonstrDead(vBot.x,vBot.y);vBot.bot.stopFollow();vBot.kill();game.state.states.Game.countMonsterKilled++},botHitHero:function(vHero,vBot){if(MainGame.gameOver)return;if(game.state.states.Game.timeUlt){this.removeBot(vBot);return}if(game.state.states.Game.heroAttack)return;game.state.states.Game.cameraSprite.body.velocity.y=0;game.state.states.Game.player.body.velocity.y=0;vBot.kill();vHero.kill();game.state.states.Game.ball.visible=false;var obj=this.layerGame.add(game.add.sprite(vHero.x,vHero.y,"ss_game1"));obj.anchor.setTo(.5,.5);obj.animations.add("battle_cloud",Phaser.Animation.generateFrameNames("battle_cloud_",0,9,"",4),30);obj.animations.play("battle_cloud",30,true);MainGame.gameOver=true;for(var i=0;i<this.enemiesTotal;i++){if(this.enemies[i].alive)this.enemies[i].stopFollow()}game.time.events.add(1e3,this.finishGame,this)},finishGame:function(){MainGame.gameOver=true;var plashka=this.fixedScreen.add(game.add.group());var backpole=plashka.add(game.add.sprite(320,142,"ss_main","btn_pole2_0000"));backpole.anchor.setTo(.5,0);this.buttonC=plashka.add(game.add.group());this.buttonC.x=320;this.buttonC.y=570;this.homeBtn=new SimpleButton(game,this,plashka,320,685,"ss_main","btn_home_0000",this.goToMenu);dataLayer.push({event:"levelCompletion",publisher:"Buongiorno",productKey:"soccerHeroes"});if(this.finishWin){this.replayBtn=new SimpleButton(game,this,plashka,320,387+50,"ss_main","btn_play_0000",this.goToLevelMenu);var text=plashka.add(game.add.text(320,230,MainGame.GAME_TEXT.goal.toUpperCase()+"!!!",MainGame.styleTextW));text.anchor.set(.5);text.scale.setTo(1.4);game.add.tween(text.scale).to({x:1.3,y:1.3},150,"Linear",true,0,3,true);MainGame.playedGames++;MainGame.winGames++;MainGame.lastResult=1;MainGame.balls=1;var cc=MainGame.winGames.toString();var txtcc="";if(cc==1){txtcc=MainGame.GAME_TEXT.you_won1+"!"}else{txtcc=MainGame.GAME_TEXT.you_won2+"!"}var txtccf=txtcc.replace("#",cc.toString());var text=plashka.add(game.add.text(320,315,txtccf,MainGame.styleText2));text.anchor.set(.5);text.scale.setTo(1)}else{MainGame.lives--;if(MainGame.lives>0){this.replayBtn=new SimpleButton(game,this,plashka,320,387+55,"ss_main","btn_replay_0000",this.replayGame)}else{this.replayBtn=new SimpleButton(game,this,plashka,320,387+55,"ss_main","btn_play_0000",this.goToLevelMenu);MainGame.playedGames++;MainGame.lastResult=0}var text=plashka.add(game.add.text(320,230,MainGame.GAME_TEXT.defeat.toUpperCase(),MainGame.styleTextL));text.anchor.set(.5);text.scale.setTo(1.4);if(MainGame.lives>=0){var heart1=plashka.add(game.add.sprite(320-75,320,"ss_main","heart_0000"));heart1.anchor.setTo(.5,.5)}if(MainGame.lives>=1){var heart2=plashka.add(game.add.sprite(320,320,"ss_main","heart_0000"));heart2.anchor.setTo(.5,.5)}if(MainGame.lives>=2){var heart3=plashka.add(game.add.sprite(320+75,320,"ss_main","heart_0000"));heart3.anchor.setTo(.5,.5)}if(MainGame.lives==2)game.add.tween(heart3.scale).to({x:.1,y:.1},600,"Back.easeIn",true,500).onComplete.add(function(){heart3.destroy()});if(MainGame.lives==1)game.add.tween(heart2.scale).to({x:.1,y:.1},600,"Back.easeIn",true,500).onComplete.add(function(){heart2.destroy()});if(MainGame.lives==0)game.add.tween(heart1.scale).to({x:.1,y:.1},600,"Back.easeIn",true,500).onComplete.add(function(){heart1.destroy()})}plashka.y=-600;game.add.tween(plashka).to({y:0},1e3,Phaser.Easing.Elastic.Out).start();game.state.states.Game.enemiesTotal=game.state.states.Game.enemies.length;for(var i=0;i<game.state.states.Game.enemiesTotal;i++){if(game.state.states.Game.enemies[i].alive)game.state.states.Game.enemies[i].tank.kill()}game.state.states.Game.enemies=[]},fnPause:function(){if(!game.sound.mute){MainGame.isGoAway=true;game.sound.mute=true}else{MainGame.isGoAway=false}},fnResume:function(){if(MainGame.isGoAway){game.sound.mute=false}}};MainGame.Menu=function(game){this.layerMain=null;this.playButton=null;this.moreGames=null;this.musicButton=null;this.creditsButton=null;this.tutorialStatus=true;this.weather=null};MainGame.Menu.prototype={create:function(){var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;game.world.setBounds(0,0,640,756);var sdvigY=140;var title=this.layerMain.add(game.add.sprite(320,170,"ss_main","logo_sh_0000"));title.anchor.setTo(.5,.5);title.scale.setTo(.9,.9);MainGame.GAME_TEXT=MainGame.TEXT_FILE[MainGame.languages[MainGame.language]];this.buttonC=this.layerMain.add(game.add.group());this.buttonC.x=320-135;this.buttonC.y=555+sdvigY;this.playButton=new SimpleButton(game,this,this.layerMain,320,555+sdvigY,"ss_main","btn_select_0000",this.startGame,1.04,MainGame.GAME_TEXT.start,0,2);this.creditsButton=new SimpleButton(game,this,this.layerMain,320+79,680+sdvigY,"ss_main","btn_credits_0000",this.goCredits);this.musicButton=this.layerMain.add(game.add.sprite(320-79,680+sdvigY,"ss_main","btn_sound_0000"));this.musicButton.anchor.setTo(.5,.5);this.musicButton.inputEnabled=true;this.musicButton.events.onInputDown.add(muteSounds,this);if(MainGame.isMusicMuted)this.musicButton.frameName="btn_sound_0001";if(MainGame.firstGo){this.musicButton.frameName="btn_sound_0001"}else{playMusic(0)}game.input.onDown.addOnce(this.playOnce,this);this.tutorialStatus=true;this.tutorHand=game.add.group();this.tutorHand.x=320-120;this.tutorHand.y=530-30;this.hand=this.tutorHand.add(game.add.sprite(0,0,"ss_main","tutorial2_0000"));this.hand.anchor.setTo(.3,.5);this.textTut=this.tutorHand.add(game.add.text(15,90,MainGame.GAME_TEXT.hold.toUpperCase(),MainGame.styleText3));this.textTut.anchor.set(.5);game.add.tween(this.tutorHand.scale).to({x:1.1,y:1.1},400,Phaser.Easing.Linear.None,true,0,-1,true);game.add.tween(this.tutorHand).to({x:320+120},1400,Phaser.Easing.Back.Out,true,0,-1,true);game.time.events.loop(1800,this.changeTutorial,this);var num=Number(MainGame.typeHero)+1;this.player=this.layerMain.add(game.add.sprite(400,415-30,"ss_game2"));this.player.animations.add("g"+MainGame.typeHero+"_run",Phaser.Animation.generateFrameNames("g"+num+"_run_",0,15,"",4),30);this.player.animations.add("g"+MainGame.typeHero+"_attack",Phaser.Animation.generateFrameNames("g"+num+"_attack_",0,18,"",4),30);this.player.animations.play("g"+MainGame.typeHero+"_run",30,true);this.player.anchor.setTo(.5,.5);fadeOut();this.isRainAdded=false;if(getRandomBool()){this.weather=new Weather(this.game);this.weather.addRain(this.layerMain,10);this.isRainAdded=true}this.btnLanguage=new SimpleButton(game,this,this.layerMain,80,55,"ss_main","language_000"+MainGame.language,this.openLanguage);this.panelLanguage=this.layerMain.add(game.add.group());this.panelBack=this.panelLanguage.add(game.add.sprite(10,20,"ss_main","panel_language_0000"));this.btnCloseLanguage=new SimpleButton(game,this,this.panelLanguage,65,120,"ss_main","btn_x_0000",this.closeLanguage);var arrL=[0,1,2,3,4,5,6,7,8];arrL.splice(MainGame.language,1);this.btnLang_1=new SimpleButton(game,this,this.panelLanguage,168,74,"ss_main","language_000"+arrL[0],this["changeLang"+arrL[0]]);this.btnLang_2=new SimpleButton(game,this,this.panelLanguage,298,74,"ss_main","language_000"+arrL[1],this["changeLang"+arrL[1]]);this.btnLang_3=new SimpleButton(game,this,this.panelLanguage,428,74,"ss_main","language_000"+arrL[2],this["changeLang"+arrL[2]]);this.btnLang_4=new SimpleButton(game,this,this.panelLanguage,558,74,"ss_main","language_000"+arrL[3],this["changeLang"+arrL[3]]);this.btnLang_5=new SimpleButton(game,this,this.panelLanguage,168,160,"ss_main","language_000"+arrL[4],this["changeLang"+arrL[4]]);this.btnLang_6=new SimpleButton(game,this,this.panelLanguage,298,160,"ss_main","language_000"+arrL[5],this["changeLang"+arrL[5]]);this.btnLang_7=new SimpleButton(game,this,this.panelLanguage,428,160,"ss_main","language_000"+arrL[6],this["changeLang"+arrL[6]]);this.btnLang_8=new SimpleButton(game,this,this.panelLanguage,558,160,"ss_main","language_000"+arrL[7],this["changeLang"+arrL[7]]);this.panelLanguage.visible=false},openLanguage:function(){this.btnLanguage.buttonC.visible=false;this.panelLanguage.visible=true;this.panelLanguage.y=-400;game.add.tween(this.panelLanguage).to({y:0},400,"Back.easeOut").start()},closeLanguage:function(){game.add.tween(this.panelLanguage).to({y:-400},400,"Back.easeIn").start();this.btnLanguage.buttonC.visible=true},changeLang0:function(){this.updateLanguage(0)},changeLang1:function(){this.updateLanguage(1)},changeLang2:function(){this.updateLanguage(2)},changeLang3:function(){this.updateLanguage(3)},changeLang4:function(){this.updateLanguage(4)},changeLang5:function(){this.updateLanguage(5)},changeLang6:function(){this.updateLanguage(6)},changeLang7:function(){this.updateLanguage(7)},changeLang8:function(){this.updateLanguage(8)},updateLanguage:function(vPar){MainGame.language=vPar;goToState("Menu")},changeTutorial:function(){this.tutorialStatus=!this.tutorialStatus;if(this.tutorialStatus){this.hand.frameName="tutorial2_0000";this.player.animations.play("g"+MainGame.typeHero+"_run",30,true);this.hand.anchor.setTo(.3,.5);this.player.anchor.setTo(.5,.5);this.textTut.setText(MainGame.GAME_TEXT.hold.toUpperCase())}else{this.hand.frameName="tutorial1_0000";this.player.animations.play("g"+MainGame.typeHero+"_attack",30,true);this.hand.anchor.setTo(.3,.46);this.player.anchor.setTo(.5,.5);this.textTut.setText(MainGame.GAME_TEXT.release_for_attack.toUpperCase())}},update:function(){this.player.x=this.tutorHand.x+2},playOnce:function(){if(!MainGame.firstGo)return;MainGame.firstGo=false;this.musicButton.frameName="btn_sound_0000";playMusic(0)},startGame:function(){MainGame.lives=MainGame.maxLives;if(this.isRainAdded)this.weather.removeRain();if(MainGame.playedGames==0){goToState("SelectTeam")}else{if(MainGame.playedGames<3){goToState("ScreenTable1")}else{if(MainGame.playedGames==3){goToState("ScreenTable2")}else{goToState("ScreenTable3")}}}},goCredits:function(){if(this.isRainAdded)this.weather.removeRain();goToState("Credits")}};Bot=function(index,game,player,vX,vY,vGate,vNumSkin){this.game=game;this.player=player;this.alive=true;this.follow=true;this.gate=vGate;this.animStop=true;this.timer=5*getRandomInt(-8,8);this.tank=vGate.add(game.add.sprite(vX,vY,"ss_game2"));this.tank.animations.add("man_runTop",Phaser.Animation.generateFrameNames("e"+vNumSkin.toString()+"_run_",0,17,"",4),30);this.tank.animations.add("man_runDown",Phaser.Animation.generateFrameNames("g"+vNumSkin.toString()+"_run_",0,19,"",4),30);this.tank.animations.play("man_runTop",30,true);this.tank.animations.currentAnim.stop();this.tank.animations.currentAnim.frame=8;this.tank.anchor.setTo(.5,.5);this.typeMob=getRandomInt(1,3);switch(this.typeMob){case 1:this.speed=450+10*getRandomInt(0,4);break;case 2:this.speed=250+10*getRandomInt(0,4);break;case 3:this.speed=200;break}this.speed+=index*10;this.tank.bot=this;game.physics.enable(this.tank,Phaser.Physics.ARCADE);this.tank.body.setSize(40,40,0,0);this.directonDown=true};Bot.prototype.update=function(){if(!this.follow)return;if(this.tank.y<1100){this.follow=false;this.tank.body.velocity.x=0;this.tank.body.velocity.y=0;return}if(this.player.y-this.tank.y<600){if(this.player.y>this.tank.y){if(!this.directonDown){this.animStop=true;this.directonDown=true}if(this.animStop){this.animStop=false;this.tank.animations.play("man_runTop",30,true)}}else{if(this.directonDown){this.animStop=true;this.directonDown=false}if(this.animStop){this.animStop=false;this.tank.animations.play("man_runDown",30,true)}}if(this.typeMob==3){this.timer++;if(this.timer>50){this.tank.x-=Math.cos(this.tank.rotation+1.57)*7;this.tank.y-=Math.sin(this.tank.rotation+1.57)*7;if(this.timer>80)this.timer=0}else{this.game.physics.arcade.moveToXY(this.tank,this.player.x,this.player.y,this.speed)}}else{this.game.physics.arcade.moveToXY(this.tank,this.player.x,this.player.y,this.speed)}if(this.player.x-this.tank.x>0){this.tank.scale.x=1}else{this.tank.scale.x=-1}}if(this.speed>170&&this.player.y<this.tank.y){this.speed-=1}};Bot.prototype.stopFollow=function(){this.follow=false;this.tank.body.velocity.x=0;this.tank.body.velocity.y=0;this.tank.animations.currentAnim.stop()};Bot.prototype.freeze=function(){this.tank.body.velocity.x=0;this.tank.body.velocity.y=0;this.tank.animations.currentAnim.stop()};MainGame.Credits=function(game){this.musicButton=null;this.backButton=null;this.layerMain=null};MainGame.Credits.prototype={create:function(){var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;this.layerMain.add(game.add.sprite(100,90,"ss_main","btn_pole_credits_0000"));var text=this.layerMain.add(game.add.text(320,200,MainGame.GAME_TEXT.credits.toUpperCase(),MainGame.styleText));text.anchor.set(.5);this.backButton=new SimpleButton(game,this,this.layerMain,320,740,"ss_main","btn_home_0000",this.goToMenu);var text=this.layerMain.add(game.add.text(320,530,"Jesse Valentine",MainGame.styleText));text.anchor.set(.5);text.scale.setTo(.85);fadeOut()},goToMenu:function(){goToState("Menu")}};MainGame.SelectTeam=function(game){this.musicButton=null;this.backButton=null;this.layerMain=null};MainGame.SelectTeam.prototype={create:function(){this.countriesAr=[MainGame.GAME_TEXT.Albania,MainGame.GAME_TEXT.France,MainGame.GAME_TEXT.Romania,MainGame.GAME_TEXT.Switzerland,MainGame.GAME_TEXT.England,MainGame.GAME_TEXT.Russia,MainGame.GAME_TEXT.Slovakia,MainGame.GAME_TEXT.Wales,MainGame.GAME_TEXT.Germany,MainGame.GAME_TEXT.Northern_Ireland,MainGame.GAME_TEXT.Poland,MainGame.GAME_TEXT.Ukraine,MainGame.GAME_TEXT.Croatia,MainGame.GAME_TEXT.Czech_Republic,MainGame.GAME_TEXT.Spain,MainGame.GAME_TEXT.Turkey,MainGame.GAME_TEXT.Belgium,MainGame.GAME_TEXT.Italy,MainGame.GAME_TEXT.Republic_of_Ireland,MainGame.GAME_TEXT.Sweden,MainGame.GAME_TEXT.Austria,MainGame.GAME_TEXT.Hungary,MainGame.GAME_TEXT.Iceland,MainGame.GAME_TEXT.Portugal];var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;var posY=55;this.layerMain.add(game.add.sprite(100,100-posY,"ss_table","btn_pole1_0000"));this.backButton=new SimpleButton(game,this,this.layerMain,320,850-posY,"ss_main","btn_home_0000",this.goToMenu);this.selectButton=new SimpleButton(game,this,this.layerMain,320,660-posY,"ss_main","btn_select_0000",this.goToGame,0,MainGame.GAME_TEXT.select,0,2);this.nextButton1=new SimpleButton(game,this,this.layerMain,320-215,660-posY,"ss_main","btn_prev_0000",this.goClickPrev);this.nextButton2=new SimpleButton(game,this,this.layerMain,320+215,660-posY,"ss_main","btn_next_0000",this.goClickNext);this.teamFlag=this.layerMain.add(game.add.sprite(320,555-posY,"ss_table","flagsz_0000"));this.teamFlag.anchor.setTo(.5,.5);this.teamSkin=this.layerMain.add(game.add.sprite(320,290-posY,"ss_table","skins_0000"));this.teamSkin.anchor.setTo(.5,.5);this.teamCountry=this.layerMain.add(game.add.text(320,482-posY,"",MainGame.styleText));this.teamCountry.anchor.set(.5);this.updateTeam();fadeOut()},goClickPrev:function(){MainGame.typeHero--;if(MainGame.typeHero<0)MainGame.typeHero=23;game.state.states.SelectTeam.updateTeam()},goClickNext:function(){MainGame.typeHero++;if(MainGame.typeHero>23)MainGame.typeHero=0;game.state.states.SelectTeam.updateTeam()},updateTeam:function(){var num=MainGame.typeHero;var suff="000";if(num>9){suff="00"}this.teamFlag.frameName="flagsz_"+suff+num;this.teamSkin.frameName="skins_"+suff+num;this.teamCountry.setText(this.countriesAr[num])},goToGame:function(){goToState("ScreenTable1")},goToMenu:function(){goToState("Menu")}};MainGame.ScreenTable1=function(game){this.backButton=null;this.selectButton=null;this.layerMain=null;this.teams=[];this.arTxt=[]};MainGame.ScreenTable1.prototype={create:function(){var tableTitles=["Pld","W","D","L","GF","GA","GD","Pts"];this.nameGroups=["A","B","C","D","E","F"];var numTeam=MainGame.typeHero;this.numGroup=0;if(numTeam>=0&&numTeam<=3){this.numGroup=0}else if(numTeam>=4&&numTeam<=7){this.numGroup=1}else if(numTeam>=8&&numTeam<=11){this.numGroup=2}else if(numTeam>=12&&numTeam<=15){this.numGroup=3}else if(numTeam>=16&&numTeam<=19){this.numGroup=4}else if(numTeam>=20&&numTeam<=23){this.numGroup=5}MainGame.ourGroup=this.numGroup;var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;this.layerMain.add(game.add.sprite(7,227,"ss_table","table_0000"));this.txtGroup=this.layerMain.add(game.add.text(320,150-30,MainGame.GAME_TEXT.group+" "+this.nameGroups[this.numGroup],MainGame.styleText2));this.txtGroup.anchor.setTo(.5,.5);this.backButton=new SimpleButton(game,this,this.layerMain,320,840-100,"ss_main","btn_home_0000",this.goToMenu);this.selectButton=new SimpleButton(game,this,this.layerMain,320,710-110,"ss_main","btn_play_0000",this.goToGame);this.nextButton1=new SimpleButton(game,this,this.layerMain,320-170,155-40,"ss_main","btn_prev_0000",this.goClickPrev);this.nextButton2=new SimpleButton(game,this,this.layerMain,320+170,155-40,"ss_main","btn_next_0000",this.goClickNext);var tableX=20;var tableY=240;this.flag1=this.layerMain.add(game.add.sprite(tableX+15,tableY+54,"ss_table","flagsMini_0000"));this.flag2=this.layerMain.add(game.add.sprite(tableX+15,tableY+102,"ss_table","flagsMini_0001"));this.flag3=this.layerMain.add(game.add.sprite(tableX+15,tableY+150,"ss_table","flagsMini_0002"));this.flag4=this.layerMain.add(game.add.sprite(tableX+15,tableY+198,"ss_table","flagsMini_0003"));var txtCols;this.arTxt=[];for(var i=0;i<8;i++){txtCols=this.layerMain.add(game.add.text(tableX+118+i*64,tableY+29,tableTitles[i],MainGame.styleTextTb));txtCols.anchor.setTo(.5,.5);for(var j=0;j<4;j++){txtCols=this.layerMain.add(game.add.text(tableX+118+i*64,tableY+75+j*48,"0",MainGame.styleTextTb));txtCols.anchor.setTo(.5,.5);this.arTxt.push(txtCols)}}var dlt=MainGame.ourGroup*4;var _team0=dlt+0;var _team1=dlt+1;var _team2=dlt+2;var _team3=dlt+3;switch(MainGame.playedGames){case 0:if(MainGame.typeHero%4==0){MainGame.typeOpponent=_team1;MainGame.team_o1=dlt+2;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==1){MainGame.typeOpponent=_team0;MainGame.team_o1=dlt+2;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==2){MainGame.typeOpponent=_team3;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+1};if(MainGame.typeHero%4==3){MainGame.typeOpponent=_team2;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+1};break;case 1:if(MainGame.playedAr[1]==0){this.updateTable(1);MainGame.playedAr[1]=1}if(MainGame.typeHero%4==0){MainGame.typeOpponent=_team2;MainGame.team_o1=dlt+1;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==1){MainGame.typeOpponent=_team3;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+2};if(MainGame.typeHero%4==2){MainGame.typeOpponent=_team0;MainGame.team_o1=dlt+1;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==3){MainGame.typeOpponent=_team1;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+2};break;case 2:if(MainGame.playedAr[2]==0){this.updateTable(2);MainGame.playedAr[2]=1}if(MainGame.typeHero%4==0){MainGame.typeOpponent=_team3;MainGame.team_o1=dlt+1;MainGame.team_o2=dlt+2};if(MainGame.typeHero%4==1){MainGame.typeOpponent=_team2;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==2){MainGame.typeOpponent=_team1;MainGame.team_o1=dlt+0;MainGame.team_o2=dlt+3};if(MainGame.typeHero%4==3){MainGame.typeOpponent=_team0;MainGame.team_o1=dlt+1;MainGame.team_o2=dlt+2};break;case 3:if(MainGame.playedAr[3]==0){this.updateTable(3);MainGame.playedAr[3]=1}break}this.updateTeam();fadeOut();MainGame.saveSaves()},updateTable:function(vNum){var ourNum=MainGame.typeHero;var oppNum=MainGame.typeOpponent;if(vNum<4){if(MainGame.lastResult==1){MainGame.teamsAll[ourNum][0]+=1;MainGame.teamsAll[ourNum][1]+=1;MainGame.teamsAll[ourNum][4]+=1;MainGame.teamsAll[oppNum][0]+=1;MainGame.teamsAll[oppNum][3]+=1;MainGame.teamsAll[oppNum][5]+=1}else if(MainGame.lastResult==0){MainGame.teamsAll[ourNum][0]+=1;MainGame.teamsAll[ourNum][3]+=1;MainGame.teamsAll[ourNum][5]+=1;MainGame.teamsAll[oppNum][0]+=1;MainGame.teamsAll[oppNum][1]+=1;MainGame.teamsAll[oppNum][4]+=1}MainGame.lastResult=-1;this.playTeams(MainGame.team_o1,MainGame.team_o2);for(var i=0;i<=5;i++){if(MainGame.ourGroup==i)continue;if(vNum==1){this.playTeams(i*4+0,i*4+1);this.playTeams(i*4+2,i*4+3)}else if(vNum==2){this.playTeams(i*4+0,i*4+2);this.playTeams(i*4+1,i*4+3)}else if(vNum==3){this.playTeams(i*4+0,i*4+3);this.playTeams(i*4+1,i*4+2)}}}},playTeams:function(vTeam1,vTeam2){var team1win=false;var team2win=false;if(MainGame.rateTeams[vTeam1]*2>Math.random()*100)team1win=true;if(MainGame.rateTeams[vTeam2]*2>Math.random()*100)team2win=true;var _goals=getRandomInt(1,2);if(team1win&&!team2win){MainGame.teamsAll[vTeam1][0]+=1;MainGame.teamsAll[vTeam1][1]+=1;MainGame.teamsAll[vTeam1][4]+=_goals;MainGame.teamsAll[vTeam2][0]+=1;MainGame.teamsAll[vTeam2][3]+=1;MainGame.teamsAll[vTeam2][5]+=_goals}else if(team2win&&!team1win){MainGame.teamsAll[vTeam1][0]+=1;MainGame.teamsAll[vTeam1][3]+=1;MainGame.teamsAll[vTeam1][5]+=_goals;MainGame.teamsAll[vTeam2][0]+=1;MainGame.teamsAll[vTeam2][1]+=1;MainGame.teamsAll[vTeam2][4]+=_goals}else{MainGame.teamsAll[vTeam1][0]+=1;MainGame.teamsAll[vTeam1][2]+=1;MainGame.teamsAll[vTeam1][4]+=1;MainGame.teamsAll[vTeam1][5]+=1;MainGame.teamsAll[vTeam2][0]+=1;MainGame.teamsAll[vTeam2][2]+=1;MainGame.teamsAll[vTeam2][4]+=1;MainGame.teamsAll[vTeam2][5]+=1}},goClickPrev:function(){this.numGroup--;if(this.numGroup<0)this.numGroup=5;this.updateTeam()},goClickNext:function(){this.numGroup++;if(this.numGroup>5)this.numGroup=0;this.updateTeam()},updateTeam:function(){this.txtGroup.setText(MainGame.GAME_TEXT.group+" "+this.nameGroups[this.numGroup]);var _team0=this.numGroup*4+0;var _team1=this.numGroup*4+1;var _team2=this.numGroup*4+2;var _team3=this.numGroup*4+3;var _ptsTeam0=this.getPtsTeam(_team0);var _ptsTeam1=this.getPtsTeam(_team1);var _ptsTeam2=this.getPtsTeam(_team2);var _ptsTeam3=this.getPtsTeam(_team3);var _gdTeam0=this.getGdTeam(_team0);var _gdTeam1=this.getGdTeam(_team1);var _gdTeam2=this.getGdTeam(_team2);var _gdTeam3=this.getGdTeam(_team3);var teamsRate=[{n:_team0,pts:_ptsTeam0,gd:_gdTeam0},{n:_team1,pts:_ptsTeam1,gd:_gdTeam1},{n:_team2,pts:_ptsTeam2,gd:_gdTeam2},{n:_team3,pts:_ptsTeam3,gd:_gdTeam3}];teamsRate.sort(function(a,b){return(b.pts>a.pts)-(a.pts>b.pts)||(b.gd>a.gd)-(a.gd>b.gd)});this.showTeamStats(teamsRate[0].n,0);this.showTeamStats(teamsRate[1].n,1);this.showTeamStats(teamsRate[2].n,2);this.showTeamStats(teamsRate[3].n,3)},getPtsTeam:function(vNum){var txtW=MainGame.teamsAll[vNum][1];var txtD=MainGame.teamsAll[vNum][2];var txtPts=txtW*3+txtD*1;return txtPts},getGdTeam:function(vNum){var txtGF=MainGame.teamsAll[vNum][4];var txtGA=MainGame.teamsAll[vNum][5];var txtGD=txtGF-txtGA;return txtGD},showTeamStats:function(vNum,vNumCols){var txtPld=MainGame.teamsAll[vNum][0];var txtW=MainGame.teamsAll[vNum][1];var txtD=MainGame.teamsAll[vNum][2];var txtL=MainGame.teamsAll[vNum][3];var txtGF=MainGame.teamsAll[vNum][4];var txtGA=MainGame.teamsAll[vNum][5];var txtGD=txtGF-txtGA;var txtPts=txtW*3+txtD*1;this.arTxt[4*0+vNumCols].setText(txtPld);this.arTxt[4*1+vNumCols].setText(txtW);this.arTxt[4*2+vNumCols].setText(txtD);this.arTxt[4*3+vNumCols].setText(txtL);this.arTxt[4*4+vNumCols].setText(txtGF);this.arTxt[4*5+vNumCols].setText(txtGA);this.arTxt[4*6+vNumCols].setText(txtGD);this.arTxt[4*7+vNumCols].setText(txtPts);var suff="000";if(vNum>9)suff="00";var frName="flagsMini_"+suff+vNum;if(vNumCols==0)this.flag1.frameName=frName;if(vNumCols==1)this.flag2.frameName=frName;if(vNumCols==2)this.flag3.frameName=frName;if(vNumCols==3)this.flag4.frameName=frName},goToGame:function(){MainGame.balls=0;if(MainGame.playedGames<3){MainGame.lives=MainGame.maxLives;goToState("Game")}else{goToState("ScreenTable2")}},goToMenu:function(){goToState("Menu")}};MainGame.ScreenTable2=function(game){this.musicButton=null;this.backButton=null;this.layerMain=null;this.numNet=1;this.groupA=[];this.groupB=[];this.groupC=[];this.groupD=[];this.groupE=[];this.groupF=[]};MainGame.ScreenTable2.prototype={create:function(){var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;this.layerMain.add(game.add.sprite(130-7,220-10-20,"ss_table","net_0000"));addLogo(0,15,1.1,false);this.textStep=this.layerMain.add(game.add.text(320,120-20,"1/8 "+MainGame.GAME_TEXT.final,MainGame.styleText2));this.textStep.anchor.setTo(.5,.5);this.txtNumNet=this.layerMain.add(game.add.text(320,165-20,"1/2",MainGame.styleText2));this.txtNumNet.anchor.setTo(.5,.5);this.backButton=new SimpleButton(game,this,this.layerMain,320-100,800,"ss_main","btn_home_0000",this.goToMenu);this.selectButton=new SimpleButton(game,this,this.layerMain,320+100,800,"ss_main","btn_play_0000",this.goToGame);this.nextButton1=new SimpleButton(game,this,this.layerMain,320-170,155-40,"ss_main","btn_prev_0000",this.goClickPrev);this.nextButton2=new SimpleButton(game,this,this.layerMain,320+170,155-40,"ss_main","btn_next_0000",this.goClickNext);this.numNet=1;this.groupA=this.resultGroup(0);this.groupB=this.resultGroup(1);this.groupC=this.resultGroup(2);this.groupD=this.resultGroup(3);this.groupE=this.resultGroup(4);this.groupF=this.resultGroup(5);this.teams3rd=[];this.team3_1=this.bestFrom3rd(this.groupB[2],this.groupE[2],this.groupF[2]);this.team3_2=this.bestFrom3rd(this.groupA[2],this.groupC[2],this.groupD[2]);this.team3_3=this.bestFrom3rd(this.groupA[2],this.groupB[2],this.groupF[2]);this.team3_4=this.bestFrom3rd(this.groupC[2],this.groupD[2],this.groupE[2]);var tableX=145;var tableY=225-20;this.flag0=this.layerMain.add(game.add.sprite(tableX+0,tableY+1,"ss_table","flagsMini_0001"));this.flag1=this.layerMain.add(game.add.sprite(tableX+0,tableY+50,"ss_table","flagsMini_0002"));this.flag2=this.layerMain.add(game.add.sprite(tableX+0,tableY+137,"ss_table","flagsMini_0003"));this.flag3=this.layerMain.add(game.add.sprite(tableX+0,tableY+135+50,"ss_table","flagsMini_0004"));this.flag4=this.layerMain.add(game.add.sprite(tableX+0,tableY+273,"ss_table","flagsMini_0005"));this.flag5=this.layerMain.add(game.add.sprite(tableX+0,tableY+272+50,"ss_table","flagsMini_0006"));this.flag6=this.layerMain.add(game.add.sprite(tableX+0,tableY+409,"ss_table","flagsMini_0007"));this.flag7=this.layerMain.add(game.add.sprite(tableX+0,tableY+407+50,"ss_table","flagsMini_0008"));MainGame.team18Final[0]=this.groupA[1];MainGame.team18Final[1]=this.groupC[1];MainGame.team18Final[2]=this.groupD[0];MainGame.team18Final[3]=this.team3_1;MainGame.team18Final[4]=this.groupB[0];MainGame.team18Final[5]=this.team3_2;MainGame.team18Final[6]=this.groupF[0];MainGame.team18Final[7]=this.groupE[1];MainGame.team18Final[8]=this.groupC[0];MainGame.team18Final[9]=this.team3_3;MainGame.team18Final[10]=this.groupE[0];MainGame.team18Final[11]=this.groupD[1];MainGame.team18Final[12]=this.groupA[0];MainGame.team18Final[13]=this.team3_4;MainGame.team18Final[14]=this.groupB[1];MainGame.team18Final[15]=this.groupF[1];for(var i=0;i<=15;i++){if(MainGame.typeHero==MainGame.team18Final[i]){if(i%2==0){MainGame.typeOpponent=MainGame.team18Final[i+1];MainGame.ourPlace14=i/2}else{MainGame.typeOpponent=MainGame.team18Final[i-1];MainGame.ourPlace14=(i-1)/2}break}}this.updateTeam();this._foundUs=false;for(var i=0;i<=15;i++){if(MainGame.typeHero==MainGame.team18Final[i]){this._foundUs=true;break}}if(!this._foundUs){this.selectButton.buttonC.visible=false;this.backButton.buttonC.x=320}fadeOut();MainGame.saveSaves()},resultGroup:function(vNumG){var _team0=vNumG*4+0;var _team1=vNumG*4+1;var _team2=vNumG*4+2;var _team3=vNumG*4+3;var _ptsTeam0=this.getPtsTeam(_team0);var _ptsTeam1=this.getPtsTeam(_team1);var _ptsTeam2=this.getPtsTeam(_team2);var _ptsTeam3=this.getPtsTeam(_team3);var _gdTeam0=this.getGdTeam(_team0);var _gdTeam1=this.getGdTeam(_team1);var _gdTeam2=this.getGdTeam(_team2);var _gdTeam3=this.getGdTeam(_team3);var teamsRate=[{n:_team0,pts:_ptsTeam0,gd:_gdTeam0},{n:_team1,pts:_ptsTeam1,gd:_gdTeam1},{n:_team2,pts:_ptsTeam2,gd:_gdTeam2},{n:_team3,pts:_ptsTeam3,gd:_gdTeam3}];teamsRate.sort(function(a,b){return(b.pts>a.pts)-(a.pts>b.pts)||(b.gd>a.gd)-(a.gd>b.gd)});return[teamsRate[0].n,teamsRate[1].n,teamsRate[2].n,teamsRate[3].n]},bestFrom3rd:function(_team0,_team1,_team2){var _ptsTeam0=this.getPtsTeam(_team0);var _ptsTeam1=this.getPtsTeam(_team1);var _ptsTeam2=this.getPtsTeam(_team2);var _gdTeam0=this.getGdTeam(_team0);var _gdTeam1=this.getGdTeam(_team1);var _gdTeam2=this.getGdTeam(_team2);var teamsRate=[{n:_team0,pts:_ptsTeam0,gd:_gdTeam0},{n:_team1,pts:_ptsTeam1,gd:_gdTeam1},{n:_team2,pts:_ptsTeam2,gd:_gdTeam2}];teamsRate.sort(function(a,b){return(b.pts>a.pts)-(a.pts>b.pts)||(b.gd>a.gd)-(a.gd>b.gd)});var _n=0;for(var i=0;i<=2;i++){if(this.teams3rd.indexOf(teamsRate[i].n)<0){_n=i;this.teams3rd.push(i);break}}return teamsRate[_n].n},getPtsTeam:function(vNum){var txtW=MainGame.teamsAll[vNum][1];var txtD=MainGame.teamsAll[vNum][2];var txtPts=txtW*3+txtD*1;return txtPts},getGdTeam:function(vNum){var txtGF=MainGame.teamsAll[vNum][4];var txtGA=MainGame.teamsAll[vNum][5];var txtGD=txtGF-txtGA;return txtGD},goClickPrev:function(){game.state.states.ScreenTable2.numNet--;if(game.state.states.ScreenTable2.numNet==0)game.state.states.ScreenTable2.numNet=2;game.state.states.ScreenTable2.updateTeam()},goClickNext:function(){game.state.states.ScreenTable2.numNet++;if(game.state.states.ScreenTable2.numNet==3)game.state.states.ScreenTable2.numNet=1;game.state.states.ScreenTable2.updateTeam()},updateTeam:function(){this.txtNumNet.setText(game.state.states.ScreenTable2.numNet+"/2");var n=0;if(game.state.states.ScreenTable2.numNet==2)n=8;this.flag0.frameName=this.getFrameNameFlag(MainGame.team18Final[n+0]);this.flag1.frameName=this.getFrameNameFlag(MainGame.team18Final[n+1]);this.flag2.frameName=this.getFrameNameFlag(MainGame.team18Final[n+2]);this.flag3.frameName=this.getFrameNameFlag(MainGame.team18Final[n+3]);this.flag4.frameName=this.getFrameNameFlag(MainGame.team18Final[n+4]);this.flag5.frameName=this.getFrameNameFlag(MainGame.team18Final[n+5]);this.flag6.frameName=this.getFrameNameFlag(MainGame.team18Final[n+6]);this.flag7.frameName=this.getFrameNameFlag(MainGame.team18Final[n+7])},getFrameNameFlag:function(vNum){var suff="000";if(vNum>9)suff="00";return"flagsMini_"+suff+vNum},goToGame:function(){MainGame.balls=0;MainGame.lives=MainGame.maxLives;goToState("Game")},goToMenu:function(){if(!this._foundUs)MainGame.initGameVars();goToState("Menu")}};MainGame.ScreenTable3=function(game){this.musicButton=null;this.backButton=null;this.layerMain=null;this.numNet=1;this.groupA=[];this.groupB=[];this.groupC=[];this.groupD=[];this.groupE=[];this.groupF=[]};MainGame.ScreenTable3.prototype={create:function(){var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;this.layerMain.add(game.add.sprite(130-7,220-10-20,"ss_table","net_0000"));addLogo(0,15,1.1,false);this.textStep=this.layerMain.add(game.add.text(320,150-20,"1/4 "+MainGame.GAME_TEXT.final,MainGame.styleText2));this.textStep.anchor.setTo(.5,.5);this.backButton=new SimpleButton(game,this,this.layerMain,320-100,800,"ss_main","btn_home_0000",this.goToMenu);this.selectButton=new SimpleButton(game,this,this.layerMain,320+100,800,"ss_main","btn_play_0000",this.goToGame);var tableX=145;var tableY=225-20;this.flag0=this.layerMain.add(game.add.sprite(tableX+0,tableY+1,"ss_table","flagsMini_0001"));this.flag1=this.layerMain.add(game.add.sprite(tableX+0,tableY+50,"ss_table","flagsMini_0002"));this.flag2=this.layerMain.add(game.add.sprite(tableX+0,tableY+137,"ss_table","flagsMini_0003"));this.flag3=this.layerMain.add(game.add.sprite(tableX+0,tableY+135+50,"ss_table","flagsMini_0004"));this.flag4=this.layerMain.add(game.add.sprite(tableX+0,tableY+273,"ss_table","flagsMini_0005"));this.flag5=this.layerMain.add(game.add.sprite(tableX+0,tableY+272+50,"ss_table","flagsMini_0006"));this.flag6=this.layerMain.add(game.add.sprite(tableX+0,tableY+409,"ss_table","flagsMini_0007"));this.flag7=this.layerMain.add(game.add.sprite(tableX+0,tableY+407+50,"ss_table","flagsMini_0008"));if(MainGame.playedGames==4)this.textStep.setText("1/4 "+MainGame.GAME_TEXT.final);if(MainGame.playedGames==4&&MainGame.playedAr[4]==0){MainGame.playedAr[4]=1;if(MainGame.lastResult==1){MainGame.team14Final[MainGame.ourPlace14]=MainGame.typeHero}else{MainGame.team14Final[MainGame.ourPlace14]=MainGame.typeOpponent}for(var i=0;i<8;i++){if(i==MainGame.ourPlace14)continue;MainGame.team14Final[i]=this.playTeams(MainGame.team18Final[i*2],MainGame.team18Final[i*2+1])}for(var i=0;i<8;i++){if(MainGame.typeHero==MainGame.team14Final[i]){if(i%2==0){MainGame.typeOpponent=MainGame.team14Final[i+1];MainGame.ourPlace12=i/2}else{MainGame.typeOpponent=MainGame.team14Final[i-1];MainGame.ourPlace12=(i-1)/2}break}}}if(MainGame.playedGames==5)this.textStep.setText("1/2 "+MainGame.GAME_TEXT.final);if(MainGame.playedGames==5&&MainGame.playedAr[5]==0){MainGame.playedAr[5]=1;if(MainGame.lastResult==1){MainGame.team12Final[MainGame.ourPlace12]=MainGame.typeHero}else{MainGame.team12Final[MainGame.ourPlace12]=MainGame.typeOpponent}for(var i=0;i<4;i++){if(i==MainGame.ourPlace12)continue;MainGame.team12Final[i]=this.playTeams(MainGame.team14Final[i*2],MainGame.team14Final[i*2+1])}for(var i=0;i<4;i++){if(MainGame.typeHero==MainGame.team12Final[i]){if(i%2==0){MainGame.typeOpponent=MainGame.team12Final[i+1];MainGame.ourPlaceFinal=i/2}else{MainGame.typeOpponent=MainGame.team12Final[i-1];MainGame.ourPlaceFinal=(i-1)/2}break}}}if(MainGame.playedGames==6)this.textStep.setText(MainGame.GAME_TEXT.final);if(MainGame.playedGames==6&&MainGame.playedAr[6]==0){MainGame.playedAr[6]=1;if(MainGame.lastResult==1){MainGame.teamFinal[MainGame.ourPlaceFinal]=MainGame.typeHero;if(MainGame.ourPlaceFinal==0){MainGame.teamFinal[1]=this.playTeams(MainGame.team12Final[2],MainGame.team12Final[3]);MainGame.typeOpponent=MainGame.teamFinal[1]}else{MainGame.teamFinal[0]=this.playTeams(MainGame.team12Final[0],MainGame.team12Final[1]);MainGame.typeOpponent=MainGame.teamFinal[0]}}else{MainGame.teamFinal[0]=this.playTeams(MainGame.team12Final[0],MainGame.team12Final[1]);MainGame.teamFinal[1]=this.playTeams(MainGame.team12Final[2],MainGame.team12Final[3])}}if(MainGame.playedGames>=4){this.updateTeam14()}if(MainGame.playedGames>=5){this.flag8=this.layerMain.add(game.add.sprite(tableX+146,tableY+65,"ss_table","flagsMini_0001"));this.flag9=this.layerMain.add(game.add.sprite(tableX+146,tableY+114,"ss_table","flagsMini_0002"));this.flag10=this.layerMain.add(game.add.sprite(tableX+146,tableY+337,"ss_table","flagsMini_0003"));this.flag11=this.layerMain.add(game.add.sprite(tableX+146,tableY+387,"ss_table","flagsMini_0004"));this.updateTeam12()}if(MainGame.playedGames>=6){this.flag12=this.layerMain.add(game.add.sprite(tableX+295,tableY+197,"ss_table","flagsMini_0001"));this.flag13=this.layerMain.add(game.add.sprite(tableX+295,tableY+245,"ss_table","flagsMini_0002"));this.updateTeamF()}if(MainGame.lastResult!=1){this.selectButton.buttonC.visible=false;this.backButton.buttonC.x=320}fadeOut();MainGame.saveSaves()},playTeams:function(vTeam1,vTeam2){var team1win=false;var team2win=false;if(MainGame.rateTeams[vTeam1]*2>Math.random()*100)team1win=true;if(MainGame.rateTeams[vTeam2]*2>Math.random()*100)team2win=true;var _goals=getRandomInt(1,2);if(team1win&&!team2win){return vTeam1}else if(team2win&&!team1win){return vTeam2}else{var _ptsTeam1=this.getPtsTeam(vTeam1);var _ptsTeam2=this.getPtsTeam(vTeam2);if(_ptsTeam1<_ptsTeam2){return vTeam2}else{return vTeam1}}},getPtsTeam:function(vNum){var txtW=MainGame.teamsAll[vNum][1];var txtD=MainGame.teamsAll[vNum][2];var txtPts=txtW*3+txtD*1;return txtPts},updateTeam14:function(){this.flag0.frameName=this.getFrameNameFlag(MainGame.team14Final[0]);this.flag1.frameName=this.getFrameNameFlag(MainGame.team14Final[1]);this.flag2.frameName=this.getFrameNameFlag(MainGame.team14Final[2]);this.flag3.frameName=this.getFrameNameFlag(MainGame.team14Final[3]);this.flag4.frameName=this.getFrameNameFlag(MainGame.team14Final[4]);this.flag5.frameName=this.getFrameNameFlag(MainGame.team14Final[5]);this.flag6.frameName=this.getFrameNameFlag(MainGame.team14Final[6]);this.flag7.frameName=this.getFrameNameFlag(MainGame.team14Final[7])},updateTeam12:function(){this.flag8.frameName=this.getFrameNameFlag(MainGame.team12Final[0]);this.flag9.frameName=this.getFrameNameFlag(MainGame.team12Final[1]);this.flag10.frameName=this.getFrameNameFlag(MainGame.team12Final[2]);this.flag11.frameName=this.getFrameNameFlag(MainGame.team12Final[3])},updateTeamF:function(){this.flag12.frameName=this.getFrameNameFlag(MainGame.teamFinal[0]);this.flag13.frameName=this.getFrameNameFlag(MainGame.teamFinal[1])},getFrameNameFlag:function(vNum){var suff="000";if(vNum>9)suff="00";return"flagsMini_"+suff+vNum},goToGame:function(){MainGame.balls=0;MainGame.lives=MainGame.maxLives;goToState("Game")},goToMenu:function(){if(MainGame.lastResult!=1){MainGame.initGameVars();MainGame.saveSaves()}goToState("Menu")}};MainGame.ScreenWin=function(game){this.layerMain=null;this.moreGames=null;this.backButton=null};MainGame.ScreenWin.prototype={create:function(){var bg=game.add.sprite(MainGame.oldWorldX,0,"ss_game1","bg2_0000");bg.anchor.setTo(.5,0);this.layerMain=game.add.group();this.layerMain.x=MainGame.sdvigX;var posY=20;var backpole=this.layerMain.add(game.add.sprite(320,110-posY,"ss_main","btn_pole2_0000"));backpole.anchor.setTo(.5,0);var star=this.layerMain.add(game.add.sprite(320,150-posY,"ss_main","btn_pole3_0000"));star.anchor.setTo(.5,0);var text=this.layerMain.add(game.add.text(320,177-posY,MainGame.GAME_TEXT.congratulation.toUpperCase()+"!",MainGame.styleText));text.anchor.set(.5);this.buttonC=this.layerMain.add(game.add.group());this.buttonC.x=320;this.buttonC.y=650-posY;this.backButton=new SimpleButton(game,this,this.layerMain,320,765-posY,"ss_main","btn_home_0000",this.goToMenu);var kubok=this.layerMain.add(game.add.sprite(320,370-posY,"ss_main","kubok_0000"));kubok.anchor.setTo(.5,.5);game.add.tween(kubok.scale).to({x:1.2,y:1.2},300,Phaser.Easing.Linear.None,true,0,-1,true);kubok.angle=-10;game.add.tween(kubok).to({angle:0},300,Phaser.Easing.Linear.None,true,0,-1,true);this.arFireworksTotal=0;this.arFireworks=[];for(var i=0;i<3;i++){this.arFireworks.push(new Firework(game,this.layerMain,0,320,300-posY));this.arFireworks.push(new Firework(game,this.layerMain,0,320,300-posY))}this.arFireworksTotal=this.arFireworks.length;fadeOut();MainGame.initGameVars();MainGame.saveSaves()},update:function(){for(var i=0;i<this.arFireworksTotal;i++){this.arFireworks[i].update()}},goToMenu:function(){goToState("Menu")}};Firework=function(game,layer,type,vX,vY){this.game=game;this.tank=layer.add(game.add.sprite(0,0,"ss_main"));this.tank.animations.add("firework",Phaser.Animation.generateFrameNames("frimework1_",0,15,"",4),30);this.timer=15;this.tank.animations.play("firework",30,true);this.arColors=[16777215,4307711,13325771,2479986,16535611,16317496];this.tank.tint=this.arColors[getRandomInt(0,5)];this.timer=0;this.posX=vX;this.posY=vY;this.tank.x=this.posX+10*getRandomInt(-20,20);this.tank.y=this.posY+10*getRandomInt(-20,20)};Firework.prototype.update=function(){if(this.tank.animations.currentAnim._frameIndex==this.timer){this.tank.x=this.posX+10*getRandomInt(-20,20);this.tank.y=this.posY+10*getRandomInt(-20,20);this.tank.tint=this.arColors[getRandomInt(0,5)]}};Weather=function(game){this.game=game};Weather.prototype.addFog=function(){var fog=this.game.add.bitmapData(this.game.width,this.game.height);fog.ctx.rect(0,0,this.game.width,this.game.height);fog.ctx.fillStyle="#b2ddc8";fog.ctx.fill();this.fogSprite=this.game.add.sprite(0,0,fog);this.fogSprite.alpha=0;this.game.add.tween(this.fogSprite).to({alpha:.7},6e3,null,true)};Weather.prototype.removeFog=function(){var fogTween=this.game.add.tween(this.fogSprite).to({alpha:0},6e3,null,true);fogTween.onComplete.add(this.fogSprite.kill(),this)};Weather.prototype.addRain=function(vLayer,vAngle){var rainParticle=this.game.add.bitmapData(15,50);rainParticle.ctx.rect(0,0,15,50);rainParticle.ctx.fillStyle="#9cc9de";rainParticle.ctx.fill();this.emitter=vLayer.add(this.game.add.emitter(this.game.world.centerX,-50,160));this.emitter.width=this.game.world.width+100;this.emitter.angle=vAngle;this.emitter.makeParticles(rainParticle);this.emitter.minParticleScale=.1;this.emitter.maxParticleScale=.3;this.emitter.setYSpeed(600,1e3);this.emitter.setXSpeed(-5,5);this.emitter.minRotation=0;this.emitter.maxRotation=0;this.emitter.start(false,1e3,6,0)};Weather.prototype.removeRain=function(){this.emitter.kill();this.emitter.destroy()};